{% extends 'personnel_base.html' %}
{% load static %}


{% block navbar %}

<nav class="navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
    <div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-center">
        <a class="navbar-brand brand-logo mr-5" href="#"><img src="{% static "images/uadb.png" %}" class="mr-2"
                alt="logo" /></a>
        <a class="navbar-brand brand-logo-mini" href="#"><img src="{% static "images/uadb.png" %}"
                alt="logo" /></a>
    </div>
    <div class="navbar-menu-wrapper d-flex align-items-center justify-content-end">
        <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
            <span class="icon-menu"></span>
        </button>
        <ul class="navbar-nav mr-lg-2">
            <li class="nav-item nav-search d-none d-lg-block">
                <div class="input-group">
                    <div class="input-group-prepend hover-cursor" id="navbar-search-icon">
                        <span class="input-group-text" id="search">
                            <!--i class="icon-search"></i-->
                        </span>
                    </div>
                    <!--input type="text" class="form-control" id="navbar-search-input" placeholder="Recherche" aria-label="search" aria-describedby="search"-->
                </div>
            </li>
        </ul>
        <ul class="navbar-nav navbar-nav-right">
            <li class="nav-item dropdown">
                <a class="nav-link count-indicator dropdown-toggle position-relative" id="notificationDropdown"
                    href="#" data-toggle="dropdown">
                    <i class="icon-bell mx-0"></i>
                    {% if nbre > 0  %}
                    <span id="notificationBadge" class="badge badge-primary badge-pill"
                        style="position: absolute;top: -1px;right: -3px;font-size: 0.6rem;padding: 2px 5px;">{{ nbre }}</span>
                    {% endif %}
                </a>
                <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list"
                    aria-labelledby="notificationDropdown" id="notificationBox">
                    <p class="mb-0 font-weight-normal float-left dropdown-header">Notifications</p>
                    {% if nbre > 0 %}
                    {% for notification in notifications %}
                    <a class="dropdown-item preview-item">
                        <div class="preview-thumbnail">
                            <div class="preview-icon bg-info">
                                <i class="ti-info-alt mx-0"></i>
                            </div>
                        </div>
                        <div class="preview-item-content">
                            <h6 class="preview-subject font-weight-normal" id="notificationDropdown">
                                {% if notification.verb %} {{ notification.verb }} {% else %} {% endif %}</h6>
                            <p class="font-weight-normal small-text mb-0 ">
                                {% if notification.description %} {{ notification.description }} {% else %} {% endif %}
                            </p>
                        </div>
                    </a>
                    {% endfor %}
                    <hr style="margin-top: 8px; margin-bottom: 0px;">
                    <div class="preview-item-content">
                        <a href="{% url 'clear_notification' %}" class="dropdown-item preview-item"
                            style="padding-left:100px">
                            <strong>Supprimer les notifications</strong>
                        </a>
                    </div>
                    {% endif %}
                </div>
            </li>
            <li class="nav-item nav-profile dropdown">
                <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" id="profileDropdown">
                    <img src="{% static "images/Avatar.jpg" %}" alt="profile" />
                </a>
                <div class="dropdown-menu dropdown-menu-right navbar-dropdown" aria-labelledby="profileDropdown">
                    <a href="{% url 'detail_etudiant' request.user.id %}" class="dropdown-item">
                        <i class="fa-solid fa-user text-primary"></i>
                        <span class="ml-2">Profil</span>
                    </a>
                    <a href="{% url 'deconnected_etudiant' %}" class="dropdown-item z-50">
                        <i class="ti-power-off text-primary"></i>
                        Déconnecter
                    </a>
                </div>
            </li>
        </ul>
        <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button"
            data-toggle="offcanvas">
            <span class="icon-menu"></span>
        </button>
    </div>
</nav>

{% endblock %}



{% block contenu %}
<div class="row">
    <div class="col-lg-6 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">
          <h4 class="card-title">Diagramme à barres</h4>
          <div>
            <canvas id="myBarChart"height="400"width="600"></canvas>
          </div>
          
          <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
          
          <script>
            const dataBar = {
              labels: ['Tickets_Petit_Dej', 'Tickets_Dejeuner', 'Ticket_Diner'],
              datasets: [{
                label: "Consommés dans l'année",
                data: [{{tickets_pdej_of_year}},{{tickets_dej_of_year}},{{tickets_diner_of_year}}],
                
                backgroundColor: {{colors|safe}},
                borderColor: {{colors|safe}},
                borderWidth: 1
  
              }]
            };
          
            const configBar = {
              type: 'bar',
              data: dataBar,
              options: {
                cutoutPercentage: 0,
                scales: {
                  y: {
                    beginAtZero: true
                  }
                }     
              }
            };
            const ctxBar = document.getElementById('myBarChart').getContext('2d');
            new Chart(ctxBar, configBar);
          </script>
        </div>
        <p class="text-center"><strong>Montant</strong> : <span class="text-info"> <strong>{{montant_total_year}}</strong> cfa</span></p>
        <p class="pl-3"> Ce diagramme à barres représente la répartition des tickets universitaires consommés au cours de l'année.</p>
      </div>
    </div>
    <!--div class="col-lg-6 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">
          <h4 class="card-title">Graphe Lineaire</h4>
          <div>
            <canvas id="myLineChart" height="400"width="600"></canvas>
          </div>
          
          <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
          
          <script>
            const dataLine = {
              labels: {{liste_entrep_name|safe}},
              datasets: [{
                label: 'Nombre Etudiants par Entreprise',
                data: {{liste_entrep_nbre|safe}},
                fill: false,
                borderColor: {{colors|safe}},
                tension: 0.4 
  
              }]
            };
          
            const configLine = {
              type: 'line',
              data: dataLine,
              options: {
                responsive: true,  
              }
              
            };
            const ctxLine = document.getElementById('myLineChart').getContext('2d');
            new Chart(ctxLine, configLine);
          </script>
        </div>
        <p class="pl-3"> Ce graphe en barres représente la répartition des étudiants en fonction des entreprises qui les accueillent le plus.</p>
      </div>
    </div-->
</div>
{% endblock %}